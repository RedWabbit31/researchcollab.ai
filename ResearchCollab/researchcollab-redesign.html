<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ResearchCollab.ai — Redesign</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,400&display=swap" rel="stylesheet"/>
<style>
/* ============================================================
   RESEARCHCOLLAB.AI — FULL PLATFORM REDESIGN
   All screens navigable via the screen switcher at top.
   Screens: Homepage · Sign In · Sign Up · Mind Map · Outline Generator
   Each screen has desktop + mobile states, menu open/closed
   ============================================================ */

/* ─── DESIGN TOKENS ─── */
:root {
  --hadfield:      #0e70ff;
  --hadfield-dark: #0a56cc;
  --hadfield-dim:  rgba(14,112,255,.12);
  --hadfield-glow: rgba(14,112,255,.25);
  --gold:          #f59b14;
  --gold-dim:      rgba(245,155,20,.15);
  --cerebral:      #cccccc;
  --cold:          #e5e5e5;
  --bleached:      #f2f2f2;
  --toxic:         #c1ffcf;
  --calcareous:    #dfecff;
  --sun:           #ffe5a4;

  --ink:           #0a0e1a;
  --ink-2:         #1a2035;
  --ink-3:         #2d3454;
  --mid:           #5a647a;
  --muted:         #8892a4;
  --white:         #ffffff;

  --font:          'Poppins', sans-serif;

  /* Major Third scale (×1.250) */
  --h1: 48.828px;
  --h2: 39.063px;
  --h3: 31.25px;
  --h4: 25px;
  --h5: 20px;
  --body: 16px;
  --sm: 12.8px;

  --r-sm: 6px;
  --r-md: 12px;
  --r-lg: 20px;
  --r-xl: 28px;
  --r-full: 100px;

  --shadow-sm: 0 1px 4px rgba(0,0,0,.08);
  --shadow-md: 0 4px 20px rgba(0,0,0,.10);
  --shadow-lg: 0 12px 48px rgba(0,0,0,.14);
  --shadow-blue: 0 4px 24px rgba(14,112,255,.35);

  --nav-h: 68px;
  --sidebar-w: 260px;
  --ease: cubic-bezier(.22,1,.36,1);
  --dur: 280ms;
}

/* ─── RESET ─── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }
body {
  font-family: var(--font);
  color: var(--ink);
  background: #fff;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  overflow-x: hidden;
}
img, svg { display: block; max-width: 100%; }
a { color: inherit; text-decoration: none; }
button, input, select, textarea { font-family: inherit; }
ul, ol { list-style: none; }

/* ─── SCREEN NAVIGATOR (dev tool) ─── */
#screen-nav {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 9999;
  background: var(--ink);
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  overflow-x: auto;
  scrollbar-width: none;
  flex-shrink: 0;
}
#screen-nav::-webkit-scrollbar { display: none; }
#screen-nav span {
  color: rgba(255,255,255,.45);
  font-size: 10px;
  font-weight: 600;
  letter-spacing: .1em;
  text-transform: uppercase;
  white-space: nowrap;
  padding-right: 8px;
}
.snav-btn {
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.12);
  color: rgba(255,255,255,.65);
  font-size: 11px;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 4px;
  cursor: pointer;
  white-space: nowrap;
  transition: all .2s;
}
.snav-btn:hover, .snav-btn.active {
  background: var(--hadfield);
  border-color: var(--hadfield);
  color: #fff;
}
body { padding-top: 36px; }

/* ─── SCREEN WRAPPER ─── */
.screen {
  display: none;
  width: 100%;
  min-height: calc(100vh - 36px);
}
.screen.active { display: block; }

/* ══════════════════════════════════════════════════════════════
   SCREEN 1 — HOMEPAGE
   ══════════════════════════════════════════════════════════════ */

/* ── Homepage Nav ── */
.hp-nav {
  position: fixed;
  top: 36px; left: 0; right: 0;
  height: var(--nav-h);
  z-index: 200;
  display: flex;
  align-items: center;
  padding: 0 40px;
  background: rgba(255,255,255,.92);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--cold);
  transition: box-shadow var(--dur) var(--ease);
}
.hp-nav.scrolled { box-shadow: var(--shadow-sm); }
.hp-nav .logo-wrap {
  display: flex; align-items: center; gap: 10px;
}
.logo-mark {
  width: 36px; height: 36px;
  background: var(--hadfield);
  border-radius: 10px;
  display: grid; place-items: center;
}
.logo-mark svg { width: 20px; height: 20px; }
.logo-text {
  font-size: 17px; font-weight: 700;
  color: var(--ink);
  letter-spacing: -.3px;
}
.logo-text span { color: var(--hadfield); }
.hp-nav-links {
  display: flex; align-items: center; gap: 6px;
  margin-left: auto;
}
.hp-nav-links a {
  font-size: 14px; font-weight: 500;
  color: var(--mid);
  padding: 8px 14px;
  border-radius: var(--r-sm);
  transition: color .2s, background .2s;
}
.hp-nav-links a:hover { color: var(--ink); background: var(--bleached); }
.hp-nav-links .btn-sign-in {
  color: var(--hadfield);
  font-weight: 600;
}
.hp-nav-links .btn-try {
  background: var(--hadfield);
  color: #fff;
  padding: 9px 20px;
  border-radius: var(--r-sm);
  font-weight: 600;
  transition: background .2s, transform .2s, box-shadow .2s;
}
.hp-nav-links .btn-try:hover {
  background: var(--hadfield-dark);
  transform: translateY(-1px);
  box-shadow: var(--shadow-blue);
}
.hp-hamburger {
  display: none;
  margin-left: auto;
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  flex-direction: column; gap: 5px;
}
.hp-hamburger span {
  display: block; width: 22px; height: 2px;
  background: var(--ink); border-radius: 2px;
  transition: all .3s;
}
.hp-mobile-menu {
  display: none;
  position: fixed;
  top: calc(36px + var(--nav-h));
  left: 0; right: 0;
  background: #fff;
  border-bottom: 1px solid var(--cold);
  padding: 16px 20px 20px;
  z-index: 199;
  box-shadow: var(--shadow-md);
}
.hp-mobile-menu a {
  display: block;
  font-size: 15px; font-weight: 500;
  color: var(--mid);
  padding: 12px 8px;
  border-bottom: 1px solid var(--bleached);
}
.hp-mobile-menu a:last-child { border: none; }
.hp-mobile-menu .mm-cta {
  margin-top: 12px;
  display: block;
  background: var(--hadfield);
  color: #fff;
  text-align: center;
  padding: 14px;
  border-radius: var(--r-sm);
  font-weight: 600;
}

/* ── Hero ── */
.hp-hero {
  padding-top: calc(var(--nav-h) + 80px);
  padding-bottom: 100px;
  min-height: 100vh;
  display: flex; align-items: center;
  position: relative;
  overflow: hidden;
  background: #fff;
}
#hero-canvas {
  position: absolute; inset: 0;
  pointer-events: none;
}
.hp-hero-inner {
  position: relative; z-index: 2;
  max-width: 1200px; margin: 0 auto;
  padding: 0 40px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  gap: 80px;
}
.hp-hero-badge {
  display: inline-flex; align-items: center; gap: 8px;
  background: var(--calcareous);
  border: 1px solid rgba(14,112,255,.2);
  color: var(--hadfield);
  font-size: 12px; font-weight: 600;
  letter-spacing: .06em; text-transform: uppercase;
  padding: 6px 14px; border-radius: var(--r-full);
  margin-bottom: 24px;
}
.hp-hero-badge span { width: 6px; height: 6px; background: var(--hadfield); border-radius: 50%; }
.hp-hero h1 {
  font-size: var(--h1);
  font-weight: 800;
  line-height: 1.1;
  letter-spacing: -.03em;
  color: var(--ink);
  margin-bottom: 24px;
}
.hp-hero h1 em {
  font-style: normal;
  color: var(--hadfield);
}
.hp-hero-sub {
  font-size: 18px; font-weight: 400;
  color: var(--mid);
  max-width: 44ch;
  line-height: 1.7;
  margin-bottom: 40px;
}

/* Topic Search Bar */
.topic-search-bar {
  display: flex;
  align-items: center;
  background: #fff;
  border: 2px solid var(--hadfield);
  border-radius: var(--r-lg);
  padding: 6px 6px 6px 20px;
  box-shadow: var(--shadow-blue);
  max-width: 540px;
  gap: 8px;
}
.topic-search-bar input {
  flex: 1;
  border: none; outline: none;
  font-size: 15px; font-weight: 400;
  color: var(--ink);
  background: transparent;
}
.topic-search-bar input::placeholder { color: var(--muted); }
.topic-search-btn {
  background: var(--hadfield);
  color: #fff;
  border: none; cursor: pointer;
  font-size: 14px; font-weight: 600;
  padding: 12px 24px;
  border-radius: var(--r-md);
  display: flex; align-items: center; gap: 8px;
  transition: background .2s, transform .15s;
  white-space: nowrap;
}
.topic-search-btn:hover { background: var(--hadfield-dark); transform: scale(1.02); }
.topic-hints {
  margin-top: 14px;
  display: flex; flex-wrap: wrap; gap: 8px;
}
.topic-hint {
  background: var(--bleached);
  border: 1px solid var(--cold);
  color: var(--mid);
  font-size: 12px; font-weight: 500;
  padding: 5px 12px; border-radius: var(--r-full);
  cursor: pointer;
  transition: all .15s;
}
.topic-hint:hover { background: var(--calcareous); color: var(--hadfield); border-color: rgba(14,112,255,.3); }

/* Hero visual */
.hp-hero-visual {
  position: relative;
  display: flex; align-items: center; justify-content: center;
}
.hero-mockup {
  width: 420px;
  background: #fff;
  border: 1px solid var(--cold);
  border-radius: var(--r-xl);
  box-shadow: var(--shadow-lg);
  padding: 20px;
  position: relative;
}
.hero-mockup-header {
  display: flex; align-items: center; gap: 6px;
  margin-bottom: 16px;
}
.mock-dot { width: 8px; height: 8px; border-radius: 50%; }
.mock-dot.r { background: #ff5f57; }
.mock-dot.y { background: #febc2e; }
.mock-dot.g { background: #28c840; }
.mock-title {
  font-size: 12px; font-weight: 600; color: var(--muted);
  margin-left: 6px;
}
/* Mini mindmap inside mockup */
.mini-map {
  position: relative;
  height: 280px;
  background: var(--bleached);
  border-radius: var(--r-md);
  overflow: hidden;
}
.mini-map svg {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
}
.m-node {
  position: absolute;
  background: #fff;
  border: 1.5px solid var(--cold);
  border-radius: var(--r-sm);
  font-size: 10px; font-weight: 600;
  color: var(--ink);
  padding: 5px 10px;
  white-space: nowrap;
  box-shadow: var(--shadow-sm);
}
.m-node.central {
  background: var(--hadfield);
  color: #fff;
  border-color: var(--hadfield);
  padding: 8px 14px;
  font-size: 11px;
  border-radius: var(--r-md);
  top: 50%; left: 50%;
  transform: translate(-50%,-50%);
}
.m-node.n1 { top: 16%; left: 10%; }
.m-node.n2 { top: 10%; right: 12%; }
.m-node.n3 { bottom: 20%; left: 8%; }
.m-node.n4 { bottom: 12%; right: 10%; }
.m-node.n5 { top: 50%; left: 5%; transform: translateY(-50%); }
.m-node.n6 { top: 50%; right: 5%; transform: translateY(-50%); }

/* ── HP Sections ── */
.hp-section {
  padding: 100px 40px;
  max-width: 1200px;
  margin: 0 auto;
}
.hp-section-label {
  display: inline-block;
  font-size: 11px; font-weight: 700;
  letter-spacing: .14em; text-transform: uppercase;
  color: var(--hadfield);
  margin-bottom: 12px;
}
.hp-section h2 {
  font-size: var(--h2);
  font-weight: 800;
  letter-spacing: -.025em;
  line-height: 1.15;
  color: var(--ink);
  margin-bottom: 20px;
}
.hp-section p {
  font-size: 18px;
  color: var(--mid);
  max-width: 52ch;
  line-height: 1.7;
  margin-bottom: 48px;
}

/* Features grid */
.features-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
}
.feature-card {
  background: var(--bleached);
  border: 1px solid var(--cold);
  border-radius: var(--r-lg);
  padding: 32px 28px;
  transition: transform .25s var(--ease), box-shadow .25s;
}
.feature-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-md);
}
.feat-icon {
  width: 48px; height: 48px;
  background: var(--calcareous);
  border: 1px solid rgba(14,112,255,.2);
  border-radius: var(--r-md);
  display: grid; place-items: center;
  margin-bottom: 20px;
  color: var(--hadfield);
  font-size: 20px;
}
.feat-title {
  font-size: 17px; font-weight: 700;
  color: var(--ink); margin-bottom: 10px;
}
.feat-desc {
  font-size: 14px !important;
  color: var(--mid);
  line-height: 1.65;
  margin: 0 !important;
  max-width: none !important;
}

/* How it works */
.how-steps {
  display: grid; grid-template-columns: repeat(3,1fr);
  gap: 32px; margin-top: 48px;
}
.step-num {
  font-size: var(--h3);
  font-weight: 800;
  color: var(--hadfield);
  opacity: .25;
  margin-bottom: 16px;
}
.step-title { font-size: 18px; font-weight: 700; color: var(--ink); margin-bottom: 10px; }
.step-desc { font-size: 14px; color: var(--mid); line-height: 1.65; }

/* Social proof */
.proof-strip {
  background: var(--bleached);
  border-top: 1px solid var(--cold);
  border-bottom: 1px solid var(--cold);
  padding: 48px 40px;
}
.proof-inner {
  max-width: 1200px; margin: 0 auto;
  display: flex; gap: 40px;
  justify-content: center; flex-wrap: wrap;
}
.proof-stat { text-align: center; }
.proof-num {
  font-size: var(--h2); font-weight: 800;
  color: var(--hadfield); line-height: 1;
  margin-bottom: 6px;
}
.proof-label { font-size: 14px; color: var(--mid); font-weight: 500; }

/* CTA Banner */
.hp-cta-banner {
  background: var(--ink);
  padding: 100px 40px;
  text-align: center;
}
.hp-cta-banner h2 {
  font-size: var(--h2); font-weight: 800;
  color: #fff; letter-spacing: -.02em;
  margin-bottom: 20px;
}
.hp-cta-banner p {
  font-size: 18px; color: rgba(255,255,255,.55);
  max-width: 44ch; margin: 0 auto 40px;
  line-height: 1.7;
}
.hp-cta-banner .topic-search-bar {
  max-width: 480px; margin: 0 auto;
  background: rgba(255,255,255,.07);
  border-color: rgba(255,255,255,.2);
  box-shadow: none;
}
.hp-cta-banner .topic-search-bar input { color: #fff; }
.hp-cta-banner .topic-search-bar input::placeholder { color: rgba(255,255,255,.35); }

/* HP Footer */
.hp-footer {
  background: var(--ink-2);
  padding: 60px 40px 32px;
}
.hp-footer-inner {
  max-width: 1200px; margin: 0 auto;
  display: grid; grid-template-columns: 2fr 1fr 1fr 1fr;
  gap: 48px; padding-bottom: 48px;
  border-bottom: 1px solid rgba(255,255,255,.08);
}
.footer-brand-col .logo-text { color: #fff; margin-bottom: 14px; display: block; }
.footer-tagline { font-size: 14px; color: rgba(255,255,255,.4); line-height: 1.7; }
.footer-col h4 {
  font-size: 11px; font-weight: 700;
  letter-spacing: .1em; text-transform: uppercase;
  color: rgba(255,255,255,.35);
  margin-bottom: 16px;
}
.footer-col a {
  display: block;
  font-size: 14px; color: rgba(255,255,255,.55);
  padding: 4px 0;
  transition: color .2s;
}
.footer-col a:hover { color: #fff; }
.hp-footer-bottom {
  max-width: 1200px; margin: 0 auto;
  display: flex; justify-content: space-between; align-items: center;
  padding-top: 24px;
}
.footer-copy { font-size: 13px; color: rgba(255,255,255,.3); }

/* ══════════════════════════════════════════════════════════════
   SCREEN 2 — SIGN IN
   ══════════════════════════════════════════════════════════════ */
.auth-screen {
  min-height: calc(100vh - 36px);
  display: grid;
  grid-template-columns: 1fr 1fr;
}
.auth-left {
  background: var(--ink);
  padding: 60px;
  display: flex; flex-direction: column;
  position: relative; overflow: hidden;
}
#auth-canvas {
  position: absolute; inset: 0;
  pointer-events: none;
}
.auth-left-logo {
  position: relative; z-index: 2;
  display: flex; align-items: center; gap: 10px;
  margin-bottom: auto;
}
.auth-left-logo .logo-text { color: #fff; }
.auth-left-content {
  position: relative; z-index: 2;
  padding-top: 100px;
}
.auth-left-tagline {
  font-size: 13px; font-weight: 600;
  letter-spacing: .12em; text-transform: uppercase;
  color: var(--hadfield); margin-bottom: 20px;
}
.auth-left h2 {
  font-size: var(--h2); font-weight: 800;
  color: #fff; line-height: 1.15;
  letter-spacing: -.02em;
  margin-bottom: 16px;
}
.auth-left p {
  font-size: 16px; color: rgba(255,255,255,.5);
  line-height: 1.7; max-width: 36ch;
}
.auth-left-pills {
  display: flex; flex-wrap: wrap; gap: 8px;
  margin-top: 36px;
}
.auth-pill {
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.1);
  color: rgba(255,255,255,.6);
  font-size: 12px; font-weight: 500;
  padding: 6px 14px; border-radius: var(--r-full);
}
.auth-right {
  background: #fff;
  display: flex; align-items: center; justify-content: center;
  padding: 60px;
}
.auth-form-box {
  width: 100%; max-width: 400px;
}
.auth-form-box h3 {
  font-size: var(--h4); font-weight: 700;
  color: var(--ink); margin-bottom: 8px;
  letter-spacing: -.02em;
}
.auth-form-box .auth-sub {
  font-size: 14px; color: var(--muted); margin-bottom: 36px;
}
.auth-form-box .auth-sub a { color: var(--hadfield); font-weight: 600; }

.form-field {
  margin-bottom: 18px;
}
.form-field label {
  display: block;
  font-size: 12px; font-weight: 600;
  letter-spacing: .04em;
  color: var(--mid); margin-bottom: 6px;
}
.form-field input {
  width: 100%;
  background: var(--bleached);
  border: 1.5px solid var(--cold);
  border-radius: var(--r-sm);
  padding: 12px 14px;
  font-size: 14px; color: var(--ink);
  outline: none;
  transition: border-color .2s, background .2s;
}
.form-field input:focus {
  border-color: var(--hadfield);
  background: #fff;
  box-shadow: 0 0 0 3px rgba(14,112,255,.12);
}
.form-field input::placeholder { color: var(--muted); }
.forgot-link {
  font-size: 12px; font-weight: 600;
  color: var(--hadfield); float: right;
}
.btn-auth {
  width: 100%;
  background: var(--hadfield);
  color: #fff; border: none; cursor: pointer;
  font-size: 15px; font-weight: 600;
  padding: 14px;
  border-radius: var(--r-sm);
  margin-top: 8px;
  transition: background .2s, transform .15s, box-shadow .2s;
  letter-spacing: -.01em;
}
.btn-auth:hover {
  background: var(--hadfield-dark);
  transform: translateY(-1px);
  box-shadow: var(--shadow-blue);
}
.auth-divider {
  display: flex; align-items: center; gap: 12px;
  margin: 24px 0; color: var(--muted); font-size: 12px; font-weight: 500;
}
.auth-divider::before, .auth-divider::after {
  content: ''; flex: 1; height: 1px; background: var(--cold);
}
.btn-social {
  width: 100%;
  display: flex; align-items: center; justify-content: center; gap: 10px;
  background: #fff;
  border: 1.5px solid var(--cold);
  border-radius: var(--r-sm);
  padding: 12px;
  font-size: 14px; font-weight: 500; color: var(--ink);
  cursor: pointer;
  transition: border-color .2s, background .2s;
  margin-bottom: 10px;
}
.btn-social:hover { border-color: var(--cerebral); background: var(--bleached); }

/* ══════════════════════════════════════════════════════════════
   SCREEN 3 — MIND MAP (App Shell)
   ══════════════════════════════════════════════════════════════ */
.app-shell {
  height: calc(100vh - 36px);
  display: flex; flex-direction: column;
  overflow: hidden;
  background: var(--bleached);
}

/* App top bar */
.app-topbar {
  height: var(--nav-h);
  background: #fff;
  border-bottom: 1px solid var(--cold);
  display: flex; align-items: center;
  padding: 0 20px;
  gap: 12px;
  flex-shrink: 0;
  z-index: 100;
  position: relative;
}
.app-logo {
  display: flex; align-items: center; gap: 8px;
  padding-right: 16px;
  border-right: 1px solid var(--cold);
}
.app-logo .logo-text { font-size: 15px; }
.topbar-topic {
  flex: 1;
  display: flex; align-items: center;
}
.topbar-topic-label {
  font-size: 13px; font-weight: 500; color: var(--muted);
  padding-right: 12px; border-right: 1px solid var(--cold);
  margin-right: 12px;
  white-space: nowrap;
}
.topbar-topic-val {
  font-size: 14px; font-weight: 600; color: var(--ink);
}
.topbar-actions {
  display: flex; align-items: center; gap: 8px;
  margin-left: auto;
}
.topbar-btn {
  height: 36px; padding: 0 14px;
  background: var(--bleached);
  border: 1px solid var(--cold);
  border-radius: var(--r-sm);
  font-size: 13px; font-weight: 500; color: var(--mid);
  cursor: pointer; display: flex; align-items: center; gap: 6px;
  transition: all .2s; white-space: nowrap;
}
.topbar-btn:hover { background: var(--cold); color: var(--ink); }
.topbar-btn.primary {
  background: var(--hadfield); color: #fff;
  border-color: var(--hadfield);
  font-weight: 600;
}
.topbar-btn.primary:hover { background: var(--hadfield-dark); box-shadow: var(--shadow-blue); }
.topbar-avatar {
  width: 32px; height: 32px;
  background: var(--hadfield);
  border-radius: 50%;
  display: grid; place-items: center;
  color: #fff; font-size: 12px; font-weight: 700;
  cursor: pointer; flex-shrink: 0;
}

/* App body */
.app-body {
  flex: 1;
  display: flex;
  overflow: hidden;
}

/* Sidebar */
.app-sidebar {
  width: var(--sidebar-w);
  background: #fff;
  border-right: 1px solid var(--cold);
  display: flex; flex-direction: column;
  overflow: hidden;
  transition: transform var(--dur) var(--ease), width var(--dur) var(--ease);
  flex-shrink: 0;
}
.app-sidebar.closed {
  width: 0;
  transform: translateX(-100%);
  overflow: hidden;
}
.sidebar-header {
  padding: 16px 16px 12px;
  border-bottom: 1px solid var(--cold);
  display: flex; align-items: center; justify-content: space-between;
  flex-shrink: 0;
}
.sidebar-title {
  font-size: 12px; font-weight: 700;
  letter-spacing: .08em; text-transform: uppercase;
  color: var(--muted);
}
.sidebar-close-btn {
  width: 24px; height: 24px;
  background: var(--bleached);
  border: 1px solid var(--cold);
  border-radius: 5px;
  cursor: pointer; display: grid; place-items: center;
  font-size: 12px; color: var(--muted);
  transition: all .2s;
}
.sidebar-close-btn:hover { background: var(--cold); color: var(--ink); }
.sidebar-search {
  padding: 12px 12px 0;
  flex-shrink: 0;
}
.sidebar-search input {
  width: 100%;
  background: var(--bleached);
  border: 1px solid var(--cold);
  border-radius: var(--r-sm);
  padding: 8px 12px;
  font-size: 13px; color: var(--ink); outline: none;
  transition: border-color .2s;
}
.sidebar-search input:focus { border-color: var(--hadfield); }
.sidebar-scroll {
  flex: 1; overflow-y: auto;
  padding: 12px;
  scrollbar-width: thin;
  scrollbar-color: var(--cold) transparent;
}
.sidebar-section-label {
  font-size: 10px; font-weight: 700;
  letter-spacing: .1em; text-transform: uppercase;
  color: var(--muted); padding: 10px 4px 6px;
}
.node-item {
  display: flex; align-items: center; gap: 10px;
  padding: 8px 10px;
  border-radius: var(--r-sm);
  cursor: pointer;
  transition: background .15s;
}
.node-item:hover { background: var(--bleached); }
.node-item.active { background: var(--calcareous); }
.node-dot {
  width: 8px; height: 8px; border-radius: 50%;
  flex-shrink: 0;
}
.node-dot.blue { background: var(--hadfield); }
.node-dot.gold { background: var(--gold); }
.node-dot.green { background: #22c55e; }
.node-dot.gray { background: var(--cerebral); }
.node-label {
  font-size: 13px; font-weight: 500; color: var(--ink);
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.node-badge {
  margin-left: auto; font-size: 10px; font-weight: 600;
  color: var(--hadfield);
  background: var(--calcareous);
  padding: 2px 6px; border-radius: 4px; flex-shrink: 0;
}

/* Canvas area */
.app-canvas {
  flex: 1;
  position: relative;
  overflow: hidden;
  background: var(--bleached);
  background-image: radial-gradient(var(--cold) 1px, transparent 1px);
  background-size: 24px 24px;
}
/* Mind map nodes */
.map-node {
  position: absolute;
  background: #fff;
  border: 1.5px solid var(--cold);
  border-radius: 10px;
  padding: 10px 16px;
  font-size: 13px; font-weight: 500;
  color: var(--ink);
  box-shadow: var(--shadow-sm);
  cursor: pointer;
  transition: transform .2s, box-shadow .2s, border-color .2s;
  white-space: nowrap;
}
.map-node:hover {
  transform: scale(1.04);
  box-shadow: var(--shadow-md);
  border-color: var(--hadfield);
  z-index: 10;
}
.map-node.central {
  background: var(--hadfield);
  color: #fff; border-color: var(--hadfield);
  font-weight: 700; font-size: 14px;
  padding: 14px 24px;
  border-radius: 14px;
  box-shadow: var(--shadow-blue);
}
.map-node.branch-1 { background: var(--calcareous); border-color: rgba(14,112,255,.3); color: var(--hadfield); font-weight: 600; }
.map-node.branch-2 { background: var(--sun); border-color: rgba(245,155,20,.3); color: #a06000; font-weight: 600; }
.map-node.branch-3 { background: var(--toxic); border-color: rgba(34,197,94,.3); color: #166534; font-weight: 600; }

/* Sticky action bar at canvas bottom */
.canvas-action-bar {
  position: absolute;
  bottom: 24px; left: 50%; transform: translateX(-50%);
  z-index: 50;
  display: flex; align-items: center; gap: 8px;
  background: #fff;
  border: 1px solid var(--cold);
  border-radius: var(--r-full);
  padding: 6px 8px;
  box-shadow: var(--shadow-lg);
}
.cab-btn {
  height: 40px; padding: 0 16px;
  border-radius: var(--r-full);
  border: none; cursor: pointer;
  font-size: 13px; font-weight: 500; color: var(--mid);
  background: transparent;
  display: flex; align-items: center; gap: 6px;
  transition: all .2s;
}
.cab-btn:hover { background: var(--bleached); color: var(--ink); }
.cab-btn.primary {
  background: var(--hadfield);
  color: #fff;
  font-weight: 600;
  padding: 0 20px;
}
.cab-btn.primary:hover { background: var(--hadfield-dark); }
.cab-divider {
  width: 1px; height: 24px; background: var(--cold);
}
/* zoom controls */
.zoom-display {
  font-size: 12px; font-weight: 600;
  color: var(--mid);
  padding: 0 10px;
}

/* Sidebar toggle (when closed) */
.sidebar-open-btn {
  position: absolute;
  top: 50%; left: 12px; transform: translateY(-50%);
  z-index: 50;
  width: 32px; height: 56px;
  background: #fff;
  border: 1px solid var(--cold);
  border-radius: var(--r-sm);
  cursor: pointer; display: grid; place-items: center;
  box-shadow: var(--shadow-sm);
  color: var(--muted); font-size: 16px;
  transition: all .2s;
}
.sidebar-open-btn:hover { color: var(--hadfield); border-color: var(--hadfield); }

/* Node context panel (right side) */
.node-panel {
  width: 280px;
  background: #fff;
  border-left: 1px solid var(--cold);
  overflow-y: auto;
  flex-shrink: 0;
  display: flex; flex-direction: column;
  transition: width var(--dur) var(--ease);
}
.node-panel.hidden { width: 0; overflow: hidden; }
.node-panel-header {
  padding: 16px;
  border-bottom: 1px solid var(--cold);
  display: flex; align-items: center; justify-content: space-between;
}
.node-panel-title {
  font-size: 14px; font-weight: 700; color: var(--ink);
}
.panel-close {
  width: 24px; height: 24px;
  background: var(--bleached);
  border: 1px solid var(--cold);
  border-radius: 5px; cursor: pointer;
  display: grid; place-items: center;
  font-size: 11px; color: var(--muted);
}
.node-panel-body { padding: 16px; }
.panel-section-title {
  font-size: 11px; font-weight: 700;
  letter-spacing: .08em; text-transform: uppercase;
  color: var(--muted); margin-bottom: 10px;
}
.panel-abstract {
  font-size: 13px; color: var(--mid); line-height: 1.65;
  margin-bottom: 16px;
}
.panel-tag {
  display: inline-flex; align-items: center;
  background: var(--calcareous);
  color: var(--hadfield);
  font-size: 11px; font-weight: 600;
  padding: 4px 10px; border-radius: var(--r-full);
  margin-right: 6px; margin-bottom: 6px;
}
.panel-action-btn {
  width: 100%; margin-top: 16px;
  padding: 11px;
  background: var(--hadfield); color: #fff;
  border: none; border-radius: var(--r-sm); cursor: pointer;
  font-size: 13px; font-weight: 600;
  transition: background .2s;
}
.panel-action-btn:hover { background: var(--hadfield-dark); }

/* ══════════════════════════════════════════════════════════════
   SCREEN 4 — OUTLINE GENERATOR
   ══════════════════════════════════════════════════════════════ */
.outline-shell {
  height: calc(100vh - 36px);
  display: flex; flex-direction: column;
  background: var(--bleached);
  overflow: hidden;
}
.outline-body {
  flex: 1; display: flex; overflow: hidden;
}

/* Outline sidebar */
.outline-sidebar {
  width: var(--sidebar-w);
  background: #fff;
  border-right: 1px solid var(--cold);
  display: flex; flex-direction: column;
  overflow: hidden;
  transition: width var(--dur) var(--ease);
  flex-shrink: 0;
}
.outline-sidebar.closed {
  width: 0; overflow: hidden;
}
.outline-sidebar-inner {
  width: var(--sidebar-w);
  flex-shrink: 0;
  display: flex; flex-direction: column;
  overflow: hidden;
  height: 100%;
}
.outline-sec-list {
  flex: 1; overflow-y: auto;
  padding: 8px;
  scrollbar-width: thin; scrollbar-color: var(--cold) transparent;
}
.osec-item {
  display: flex; align-items: center; gap: 8px;
  padding: 9px 10px;
  border-radius: var(--r-sm); cursor: pointer;
  transition: background .15s;
}
.osec-item:hover { background: var(--bleached); }
.osec-item.active { background: var(--calcareous); }
.osec-num {
  width: 22px; height: 22px;
  background: var(--hadfield-dim);
  border-radius: 5px;
  display: grid; place-items: center;
  font-size: 10px; font-weight: 700; color: var(--hadfield);
  flex-shrink: 0;
}
.osec-label {
  font-size: 13px; font-weight: 500; color: var(--ink);
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.osec-item.active .osec-label { font-weight: 600; color: var(--hadfield); }

/* Outline main area */
.outline-main {
  flex: 1; overflow-y: auto;
  padding: 48px 64px;
  background: #fff;
}
.outline-doc-header {
  max-width: 720px; margin: 0 auto 48px;
  padding-bottom: 32px;
  border-bottom: 2px solid var(--cold);
}
.outline-doc-tag {
  display: inline-block;
  font-size: 11px; font-weight: 700;
  letter-spacing: .12em; text-transform: uppercase;
  color: var(--hadfield);
  background: var(--calcareous);
  padding: 5px 12px; border-radius: var(--r-full);
  margin-bottom: 16px;
}
.outline-doc-title {
  font-size: var(--h2); font-weight: 800;
  color: var(--ink); line-height: 1.15;
  letter-spacing: -.025em; margin-bottom: 16px;
}
.outline-doc-meta {
  display: flex; gap: 24px; flex-wrap: wrap;
}
.outline-meta-item {
  display: flex; align-items: center; gap: 6px;
  font-size: 13px; color: var(--muted); font-weight: 500;
}
.outline-meta-icon {
  width: 16px; height: 16px; opacity: .6;
}

/* Outline sections */
.outline-section {
  max-width: 720px; margin: 0 auto 40px;
}
.outline-section-head {
  display: flex; align-items: baseline; gap: 12px;
  margin-bottom: 14px;
}
.outline-sec-num {
  font-size: var(--h5); font-weight: 800;
  color: var(--hadfield); min-width: 28px;
}
.outline-sec-title {
  font-size: var(--h4); font-weight: 700;
  color: var(--ink); letter-spacing: -.015em;
  border-bottom: 2px solid var(--cold);
  padding-bottom: 10px; flex: 1;
}
.outline-subsections { padding-left: 40px; }
.outline-subsec {
  display: flex; align-items: baseline; gap: 10px;
  padding: 8px 0;
  border-bottom: 1px solid var(--bleached);
}
.outline-subsec-num {
  font-size: 14px; font-weight: 700;
  color: var(--muted); min-width: 36px; font-variant-numeric: tabular-nums;
}
.outline-subsec-title {
  font-size: 16px; font-weight: 600; color: var(--ink);
  flex: 1;
}
.outline-subsec-desc {
  font-size: 14px; color: var(--muted);
  line-height: 1.65; margin-top: 4px; padding-left: 46px;
  margin-bottom: 4px;
}
.outline-keywords {
  padding-left: 46px; margin-top: 8px;
  display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 16px;
}
.outline-kw {
  font-size: 11px; font-weight: 600;
  background: var(--bleached);
  border: 1px solid var(--cold);
  color: var(--mid);
  padding: 3px 10px; border-radius: var(--r-full);
}

/* Outline right panel */
.outline-right {
  width: 260px; flex-shrink: 0;
  background: var(--bleached);
  border-left: 1px solid var(--cold);
  overflow-y: auto;
  padding: 16px;
}
.outline-right.hidden { width: 0; overflow: hidden; padding: 0; }
.or-title {
  font-size: 11px; font-weight: 700;
  letter-spacing: .08em; text-transform: uppercase;
  color: var(--muted); margin-bottom: 12px;
}
.or-suggestion {
  background: #fff;
  border: 1px solid var(--cold);
  border-radius: var(--r-md);
  padding: 12px;
  margin-bottom: 10px;
  cursor: pointer;
  transition: border-color .2s, box-shadow .2s;
}
.or-suggestion:hover {
  border-color: var(--hadfield);
  box-shadow: 0 0 0 3px var(--hadfield-dim);
}
.or-sug-label { font-size: 12px; font-weight: 600; color: var(--hadfield); margin-bottom: 4px; }
.or-sug-text { font-size: 12px; color: var(--mid); line-height: 1.5; }

/* ── Sticky action bar (outline) ── */
.outline-action-bar {
  position: fixed;
  bottom: 24px; left: 50%; transform: translateX(-50%);
  z-index: 200;
  display: flex; align-items: center; gap: 10px;
  background: var(--ink);
  border-radius: var(--r-full);
  padding: 8px 10px;
  box-shadow: 0 8px 40px rgba(10,14,26,.35);
}
.oab-btn {
  height: 44px; padding: 0 20px;
  border-radius: var(--r-full);
  border: none; cursor: pointer;
  font-size: 13px; font-weight: 500;
  color: rgba(255,255,255,.6);
  background: rgba(255,255,255,.08);
  display: flex; align-items: center; gap: 6px;
  transition: all .2s;
}
.oab-btn:hover { background: rgba(255,255,255,.14); color: #fff; }
.oab-btn.primary {
  background: var(--hadfield);
  color: #fff; font-weight: 600;
}
.oab-btn.primary:hover { background: var(--hadfield-dark); }
.oab-btn.gold {
  background: var(--gold);
  color: #fff; font-weight: 600;
}
.oab-btn.gold:hover { background: #d4850f; }
.oab-sep { width: 1px; height: 24px; background: rgba(255,255,255,.12); }

/* ══════════════════════════════════════════════════════════════
   MOBILE OVERLAY STATES
   ══════════════════════════════════════════════════════════════ */
.mobile-toggle-bar {
  display: none;
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: #fff;
  border-top: 1px solid var(--cold);
  padding: 8px 16px;
  z-index: 150;
  gap: 8px;
}
.mob-action-btn {
  flex: 1;
  height: 48px;
  border-radius: var(--r-sm);
  border: none; cursor: pointer;
  font-size: 14px; font-weight: 600;
  display: flex; align-items: center; justify-content: center; gap: 6px;
  transition: all .2s;
}
.mob-action-btn.secondary {
  background: var(--bleached); color: var(--ink);
  border: 1px solid var(--cold);
}
.mob-action-btn.primary {
  background: var(--hadfield); color: #fff;
}

/* ══════════════════════════════════════════════════════════════
   SCREEN VIEWER TABS (inside each screen for menu open/closed)
   ══════════════════════════════════════════════════════════════ */
.state-tabs {
  display: flex; gap: 0;
  background: var(--ink-2);
  padding: 6px 12px;
  position: sticky; top: 36px; z-index: 180;
}
.state-tab {
  font-size: 11px; font-weight: 600;
  letter-spacing: .04em;
  color: rgba(255,255,255,.45);
  padding: 5px 14px;
  border-radius: 4px;
  cursor: pointer;
  transition: all .2s;
  border: none; background: transparent;
}
.state-tab:hover { color: rgba(255,255,255,.75); }
.state-tab.active {
  background: rgba(255,255,255,.1);
  color: #fff;
}

/* ══════════════════════════════════════════════════════════════
   RESPONSIVE — MOBILE
   ══════════════════════════════════════════════════════════════ */
@media (max-width: 768px) {

  /* Homepage nav */
  .hp-nav { padding: 0 20px; }
  .hp-nav-links { display: none; }
  .hp-hamburger { display: flex; }

  /* Hero */
  .hp-hero-inner {
    grid-template-columns: 1fr;
    gap: 48px;
    padding: 0 20px;
  }
  .hp-hero { padding-top: calc(var(--nav-h) + 40px); padding-bottom: 60px; }
  .hp-hero h1 { font-size: 2.4rem; }
  .hp-hero-visual { justify-content: flex-start; }
  .hero-mockup { width: 100%; }

  /* Sections */
  .hp-section { padding: 60px 20px; }
  .hp-section h2 { font-size: var(--h3); }
  .features-grid { grid-template-columns: 1fr; }
  .how-steps { grid-template-columns: 1fr; gap: 24px; }

  /* Proof */
  .proof-strip { padding: 40px 20px; }
  .proof-inner { gap: 24px; }

  /* CTA banner */
  .hp-cta-banner { padding: 60px 20px; }
  .hp-cta-banner h2 { font-size: var(--h3); }

  /* Footer */
  .hp-footer-inner { grid-template-columns: 1fr 1fr; }
  .hp-footer { padding: 48px 20px 24px; }
  .hp-footer-bottom { flex-direction: column; align-items: flex-start; gap: 8px; }

  /* Auth */
  .auth-screen { grid-template-columns: 1fr; }
  .auth-left { display: none; }
  .auth-right { padding: 40px 24px; align-items: flex-start; }

  /* App */
  .app-sidebar { position: fixed; top: calc(36px + var(--nav-h)); bottom: 0; left: 0; z-index: 150; }
  .app-sidebar.closed { transform: translateX(-100%); }
  .node-panel { position: fixed; top: calc(36px + var(--nav-h)); bottom: 0; right: 0; width: 280px; z-index: 150; }
  .node-panel.hidden { transform: translateX(100%); width: 280px; }
  .topbar-topic { display: none; }
  .mobile-toggle-bar { display: flex; }
  .canvas-action-bar { bottom: 80px; }
  .outline-right { display: none; }
  .outline-main { padding: 32px 20px 100px; }
  .outline-action-bar { bottom: 80px; }
  .outline-sidebar {
    position: fixed; top: calc(36px + var(--nav-h)); bottom: 0; left: 0; z-index: 150;
    width: var(--sidebar-w);
  }
  .outline-sidebar.closed { transform: translateX(-100%); }
}

/* ══════════════════════════════════════════════════════════════
   SVG CONNECTOR LINES (mindmap)
   ══════════════════════════════════════════════════════════════ */
.map-svg {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  pointer-events: none;
}
.map-svg line {
  stroke: var(--cold); stroke-width: 1.5;
}
.map-svg line.branch-1-line { stroke: rgba(14,112,255,.25); }
.map-svg line.branch-2-line { stroke: rgba(245,155,20,.25); }
.map-svg line.branch-3-line { stroke: rgba(34,197,94,.25); }

/* ── Animations ── */
@keyframes fadeUp {
  from { opacity:0; transform: translateY(20px); }
  to   { opacity:1; transform: translateY(0); }
}
@keyframes pulse-ring {
  0%   { transform: scale(1); opacity: .6; }
  100% { transform: scale(1.5); opacity: 0; }
}
.map-node.central::after {
  content: '';
  position: absolute; inset: -6px;
  border: 2px solid var(--hadfield);
  border-radius: 18px;
  animation: pulse-ring 2.5s ease-out infinite;
  pointer-events: none;
}

/* ── Mobile sidebar overlay backdrop ── */
.sidebar-backdrop {
  display: none;
  position: fixed; inset: 0;
  background: rgba(10,14,26,.4);
  z-index: 140;
  backdrop-filter: blur(2px);
}
.sidebar-backdrop.visible { display: block; }

</style>
</head>
<body>

<!-- ════════════════════════════════════════════════════════════
     SCREEN NAVIGATOR (Design Switcher)
     ════════════════════════════════════════════════════════════ -->
<nav id="screen-nav">
  <span>SCREENS:</span>
  <button class="snav-btn active" onclick="showScreen('homepage')">1 · Homepage</button>
  <button class="snav-btn" onclick="showScreen('signin')">2a · Sign In</button>
  <button class="snav-btn" onclick="showScreen('signup')">2b · Sign Up</button>
  <button class="snav-btn" onclick="showScreen('mindmap')">3 · Mind Map</button>
  <button class="snav-btn" onclick="showScreen('outline')">4 · Outline Generator</button>
</nav>


<!-- ════════════════════════════════════════════════════════════
     SCREEN 1 — HOMEPAGE
     ════════════════════════════════════════════════════════════ -->
<div class="screen active" id="screen-homepage">

  <!-- State tabs for nav open/closed -->
  <div class="state-tabs">
    <button class="state-tab active" onclick="toggleMobileMenu(false)">Menu Closed</button>
    <button class="state-tab" onclick="toggleMobileMenu(true)">Menu Open (Mobile)</button>
  </div>

  <!-- Navigation -->
  <nav class="hp-nav" id="hp-nav">
    <div class="logo-wrap">
      <div class="logo-mark">
        <svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="10" cy="10" r="3" fill="white"/>
          <circle cx="10" cy="3" r="1.5" fill="white" opacity=".7"/>
          <circle cx="10" cy="17" r="1.5" fill="white" opacity=".7"/>
          <circle cx="3" cy="10" r="1.5" fill="white" opacity=".7"/>
          <circle cx="17" cy="10" r="1.5" fill="white" opacity=".7"/>
          <line x1="10" y1="10" x2="10" y2="4.5" stroke="white" stroke-width="1" opacity=".5"/>
          <line x1="10" y1="10" x2="10" y2="15.5" stroke="white" stroke-width="1" opacity=".5"/>
          <line x1="10" y1="10" x2="4.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/>
          <line x1="10" y1="10" x2="15.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/>
        </svg>
      </div>
      <span class="logo-text">Research<span>Collab</span>.ai</span>
    </div>
    <div class="hp-nav-links" id="hp-nav-links">
      <a href="#">Features</a>
      <a href="#">For Researchers</a>
      <a href="#">Pricing</a>
      <a href="#">About</a>
      <a href="#" class="btn-sign-in" onclick="showScreen('signin'); return false;">Sign In</a>
      <a href="#" class="btn-try" onclick="showScreen('signup'); return false;">Start Free</a>
    </div>
    <button class="hp-hamburger" id="hp-hamburger" onclick="toggleMobileMenu()" aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
  </nav>

  <!-- Mobile menu -->
  <div class="hp-mobile-menu" id="hp-mobile-menu">
    <a href="#">Features</a>
    <a href="#">For Researchers</a>
    <a href="#">Pricing</a>
    <a href="#">About</a>
    <a href="#" class="mm-cta" onclick="showScreen('signup'); return false;">Start Free — No Credit Card</a>
  </div>

  <!-- Hero -->
  <section class="hp-hero">
    <canvas id="hero-canvas"></canvas>
    <div class="hp-hero-inner">
      <div class="hp-hero-copy">
        <div class="hp-hero-badge">
          <span></span>
          Trusted by doctoral scholars & founders
        </div>
        <h1>Map your research.<br/><em>Faster.</em></h1>
        <p class="hp-hero-sub">
          ResearchCollab.ai transforms any topic into a living, visual knowledge graph — with AI-guided citations, outlines, and connections you didn't know existed.
        </p>
        <div class="topic-search-bar" id="hero-search">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" style="flex-shrink:0; opacity:.4">
            <circle cx="7" cy="7" r="5" stroke="#0a0e1a" stroke-width="1.5"/>
            <path d="M11 11l3 3" stroke="#0a0e1a" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <input type="text" placeholder="Enter a research topic, e.g. &quot;Quantum cognition&quot;" id="hero-input"/>
          <button class="topic-search-btn" onclick="showScreen('mindmap')">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
              <path d="M2 7h10M8 3l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Explore Topic
          </button>
        </div>
        <div class="topic-hints">
          <span class="topic-hint">Quantum cognition</span>
          <span class="topic-hint">AI ethics in healthcare</span>
          <span class="topic-hint">Climate economics</span>
          <span class="topic-hint">Gene therapy</span>
        </div>
      </div>
      <div class="hp-hero-visual">
        <div class="hero-mockup">
          <div class="hero-mockup-header">
            <div class="mock-dot r"></div>
            <div class="mock-dot y"></div>
            <div class="mock-dot g"></div>
            <span class="mock-title">Visual Mind Map · Quantum Cognition</span>
          </div>
          <div class="mini-map" id="mini-map">
            <svg id="mini-svg"></svg>
            <div class="m-node central" id="mc">Quantum Cognition</div>
            <div class="m-node n1" id="mn1">Superposition Models</div>
            <div class="m-node n2" id="mn2">Decision Theory</div>
            <div class="m-node n3" id="mn3">Neural Correlates</div>
            <div class="m-node n4" id="mn4">Cognitive Bias</div>
            <div class="m-node n5" id="mn5">Wave Function</div>
            <div class="m-node n6" id="mn6">Entanglement</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Proof strip -->
  <div class="proof-strip">
    <div class="proof-inner">
      <div class="proof-stat">
        <p class="proof-num">40K+</p>
        <p class="proof-label">Researchers</p>
      </div>
      <div class="proof-stat">
        <p class="proof-num">2M+</p>
        <p class="proof-label">Mind Maps Created</p>
      </div>
      <div class="proof-stat">
        <p class="proof-num">180+</p>
        <p class="proof-label">Countries</p>
      </div>
      <div class="proof-stat">
        <p class="proof-num">4.9★</p>
        <p class="proof-label">Average Rating</p>
      </div>
    </div>
  </div>

  <!-- Features -->
  <section class="hp-section">
    <p class="hp-section-label">The Platform</p>
    <h2>Research intelligence,<br/>beautifully structured.</h2>
    <p>From a single topic, we surface the concepts, connections, and scholarly context that take months to map manually.</p>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feat-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
            <circle cx="11" cy="11" r="3.5" fill="currentColor"/>
            <circle cx="5" cy="5" r="2" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="17" cy="5" r="2" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="5" cy="17" r="2" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="17" cy="17" r="2" stroke="currentColor" stroke-width="1.5"/>
            <line x1="11" y1="7.5" x2="6.4" y2="6.4" stroke="currentColor" stroke-width="1.2"/>
            <line x1="11" y1="7.5" x2="15.6" y2="6.4" stroke="currentColor" stroke-width="1.2"/>
            <line x1="11" y1="14.5" x2="6.4" y2="15.6" stroke="currentColor" stroke-width="1.2"/>
            <line x1="11" y1="14.5" x2="15.6" y2="15.6" stroke="currentColor" stroke-width="1.2"/>
          </svg>
        </div>
        <p class="feat-title">Visual Mind Map</p>
        <p class="feat-desc">An interactive, zoomable knowledge graph that makes the full landscape of your topic visible at a glance. Expand any node to dive deeper.</p>
      </div>
      <div class="feature-card">
        <div class="feat-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
            <rect x="3" y="3" width="16" height="16" rx="2" stroke="currentColor" stroke-width="1.5"/>
            <line x1="7" y1="8" x2="15" y2="8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="7" y1="11" x2="15" y2="11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="7" y1="14" x2="11" y2="14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </div>
        <p class="feat-title">Outline Generator</p>
        <p class="feat-desc">Transforms your chosen nodes into a formal, typographically precise research outline — ready to export as a working document.</p>
      </div>
      <div class="feature-card">
        <div class="feat-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
            <path d="M11 4v14M4 11h14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </div>
        <p class="feat-title">Citation Discovery</p>
        <p class="feat-desc">Surfaces relevant academic sources, papers, and citations for every node — with direct links and formatted references.</p>
      </div>
      <div class="feature-card">
        <div class="feat-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
            <path d="M3 11l5 5L19 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <p class="feat-title">Zero Scroll Actions</p>
        <p class="feat-desc">Every primary action is persistently visible. Generate, export, and navigate — without hunting for buttons.</p>
      </div>
      <div class="feature-card">
        <div class="feat-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
            <circle cx="11" cy="8" r="3" stroke="currentColor" stroke-width="1.5"/>
            <path d="M5 18a6 6 0 0 1 12 0" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </div>
        <p class="feat-title">Team Collaboration</p>
        <p class="feat-desc">Share mind maps with colleagues, annotate nodes, and build on each other's research in real time.</p>
      </div>
      <div class="feature-card">
        <div class="feat-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
            <rect x="4" y="14" width="4" height="5" rx="1" fill="currentColor" opacity=".3"/>
            <rect x="9" y="10" width="4" height="9" rx="1" fill="currentColor" opacity=".6"/>
            <rect x="14" y="6" width="4" height="13" rx="1" fill="currentColor"/>
          </svg>
        </div>
        <p class="feat-title">Research Analytics</p>
        <p class="feat-desc">Track how your knowledge graph grows over time. See which topics have the richest source support and identify coverage gaps.</p>
      </div>
    </div>
  </section>

  <!-- How it works -->
  <div style="background: var(--bleached); border-top:1px solid var(--cold); border-bottom:1px solid var(--cold);">
    <section class="hp-section">
      <p class="hp-section-label">How It Works</p>
      <h2>From idea to insight<br/>in three steps.</h2>
      <p>No configuration. No manual tagging. Just a topic and a few clicks.</p>
      <div class="how-steps">
        <div>
          <p class="step-num">01</p>
          <p class="step-title">Enter your research topic</p>
          <p class="step-desc">Type any subject — broad or narrow. Our AI begins mapping the knowledge graph immediately.</p>
        </div>
        <div>
          <p class="step-num">02</p>
          <p class="step-title">Explore the Mind Map</p>
          <p class="step-desc">Navigate a rich, interactive graph of concepts, sub-topics, and scholarly connections. Expand, filter, and focus.</p>
        </div>
        <div>
          <p class="step-num">03</p>
          <p class="step-title">Generate your Outline</p>
          <p class="step-desc">Select the nodes that matter to your research and instantly produce a structured, formal outline with citations.</p>
        </div>
      </div>
    </section>
  </div>

  <!-- CTA Banner -->
  <div class="hp-cta-banner">
    <h2>Start mapping your research today.</h2>
    <p>Join 40,000+ researchers, strategists, and founders using ResearchCollab.ai to accelerate discovery.</p>
    <div class="topic-search-bar">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" style="flex-shrink:0; opacity:.35">
        <circle cx="7" cy="7" r="5" stroke="white" stroke-width="1.5"/>
        <path d="M11 11l3 3" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
      </svg>
      <input type="text" placeholder="Enter your first topic…" style="color:#fff"/>
      <button class="topic-search-btn" onclick="showScreen('mindmap')">Get Started Free</button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="hp-footer">
    <div class="hp-footer-inner">
      <div class="footer-brand-col">
        <span class="logo-text">Research<span>Collab</span>.ai</span>
        <p class="footer-tagline">The research intelligence platform for scholars, strategists, and founders who demand depth.</p>
      </div>
      <div class="footer-col">
        <h4>Product</h4>
        <a href="#">Mind Map</a>
        <a href="#">Outline Generator</a>
        <a href="#">Citations</a>
        <a href="#">Collaboration</a>
      </div>
      <div class="footer-col">
        <h4>Company</h4>
        <a href="#">About</a>
        <a href="#">Blog</a>
        <a href="#">Careers</a>
        <a href="#">Press</a>
      </div>
      <div class="footer-col">
        <h4>Support</h4>
        <a href="#">Documentation</a>
        <a href="#">Pricing</a>
        <a href="#">Privacy</a>
        <a href="#">Terms</a>
      </div>
    </div>
    <div class="hp-footer-bottom">
      <p class="footer-copy">© 2025 ResearchCollab.ai. All rights reserved.</p>
      <p class="footer-copy">Built for thinkers.</p>
    </div>
  </footer>

</div><!-- end screen-homepage -->


<!-- ════════════════════════════════════════════════════════════
     SCREEN 2A — SIGN IN
     ════════════════════════════════════════════════════════════ -->
<div class="screen" id="screen-signin">
  <div class="auth-screen">
    <div class="auth-left">
      <canvas id="auth-canvas" style="position:absolute;inset:0;pointer-events:none;"></canvas>
      <div class="auth-left-logo">
        <div class="logo-mark">
          <svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="3" fill="white"/><circle cx="10" cy="3" r="1.5" fill="white" opacity=".7"/><circle cx="10" cy="17" r="1.5" fill="white" opacity=".7"/><circle cx="3" cy="10" r="1.5" fill="white" opacity=".7"/><circle cx="17" cy="10" r="1.5" fill="white" opacity=".7"/><line x1="10" y1="10" x2="10" y2="4.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="10" y2="15.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="4.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="15.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/></svg>
        </div>
        <span class="logo-text">Research<span>Collab</span>.ai</span>
      </div>
      <div class="auth-left-content">
        <p class="auth-left-tagline">The Research Intelligence Platform</p>
        <h2>Welcome<br/>back.</h2>
        <p>Your knowledge graph is waiting. Dive back into your research where you left off.</p>
        <div class="auth-left-pills">
          <span class="auth-pill">Visual Mind Maps</span>
          <span class="auth-pill">AI Outline Generator</span>
          <span class="auth-pill">Citation Discovery</span>
          <span class="auth-pill">Team Collaboration</span>
        </div>
      </div>
    </div>
    <div class="auth-right">
      <div class="auth-form-box">
        <h3>Sign in to your account</h3>
        <p class="auth-sub">No account yet? <a href="#" onclick="showScreen('signup'); return false;">Create one free →</a></p>

        <button class="btn-social">
          <svg width="18" height="18" viewBox="0 0 18 18"><path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z" fill="#34A853"/><path d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/><path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z" fill="#EA4335"/></svg>
          Continue with Google
        </button>

        <div class="auth-divider">or sign in with email</div>

        <div class="form-field">
          <label>Email address</label>
          <input type="email" placeholder="you@university.edu"/>
        </div>
        <div class="form-field">
          <label>Password <a href="#" class="forgot-link">Forgot password?</a></label>
          <input type="password" placeholder="••••••••••"/>
        </div>

        <button class="btn-auth" onclick="showScreen('mindmap')">Sign In →</button>

        <p style="font-size:12px; color:var(--muted); margin-top:20px; line-height:1.6;">By signing in, you agree to our <a href="#" style="color:var(--hadfield)">Terms of Service</a> and <a href="#" style="color:var(--hadfield)">Privacy Policy</a>.</p>
      </div>
    </div>
  </div>
</div>


<!-- ════════════════════════════════════════════════════════════
     SCREEN 2B — SIGN UP
     ════════════════════════════════════════════════════════════ -->
<div class="screen" id="screen-signup">
  <div class="auth-screen">
    <div class="auth-left">
      <canvas id="auth-canvas-2" style="position:absolute;inset:0;pointer-events:none;"></canvas>
      <div class="auth-left-logo">
        <div class="logo-mark">
          <svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="3" fill="white"/><circle cx="10" cy="3" r="1.5" fill="white" opacity=".7"/><circle cx="10" cy="17" r="1.5" fill="white" opacity=".7"/><circle cx="3" cy="10" r="1.5" fill="white" opacity=".7"/><circle cx="17" cy="10" r="1.5" fill="white" opacity=".7"/><line x1="10" y1="10" x2="10" y2="4.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="10" y2="15.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="4.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="15.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/></svg>
        </div>
        <span class="logo-text">Research<span>Collab</span>.ai</span>
      </div>
      <div class="auth-left-content">
        <p class="auth-left-tagline">Start for free today</p>
        <h2>Your research,<br/>amplified.</h2>
        <p>Join 40,000+ scholars, strategists, and founders who use ResearchCollab.ai to discover faster.</p>
        <div class="auth-left-pills">
          <span class="auth-pill">✓ No credit card required</span>
          <span class="auth-pill">✓ Free forever tier</span>
          <span class="auth-pill">✓ Up to 10 mind maps</span>
        </div>
      </div>
    </div>
    <div class="auth-right">
      <div class="auth-form-box">
        <h3>Create your account</h3>
        <p class="auth-sub">Already have one? <a href="#" onclick="showScreen('signin'); return false;">Sign in →</a></p>

        <button class="btn-social">
          <svg width="18" height="18" viewBox="0 0 18 18"><path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z" fill="#34A853"/><path d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/><path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z" fill="#EA4335"/></svg>
          Sign up with Google
        </button>

        <div class="auth-divider">or sign up with email</div>

        <div class="form-field">
          <label>Full Name</label>
          <input type="text" placeholder="Dr. Jane Smith"/>
        </div>
        <div class="form-field">
          <label>Email address</label>
          <input type="email" placeholder="you@university.edu"/>
        </div>
        <div class="form-field">
          <label>Password</label>
          <input type="password" placeholder="Min. 8 characters"/>
        </div>

        <div style="display:flex; align-items:flex-start; gap:10px; margin:16px 0;">
          <input type="checkbox" id="agree" style="width:16px;height:16px;margin-top:2px;accent-color:var(--hadfield)"/>
          <label for="agree" style="font-size:12px; color:var(--muted); line-height:1.5;">I agree to the <a href="#" style="color:var(--hadfield)">Terms of Service</a> and <a href="#" style="color:var(--hadfield)">Privacy Policy</a></label>
        </div>

        <button class="btn-auth" onclick="showScreen('mindmap')">Create Free Account →</button>
      </div>
    </div>
  </div>
</div>


<!-- ════════════════════════════════════════════════════════════
     SCREEN 3 — MIND MAP
     ════════════════════════════════════════════════════════════ -->
<div class="screen" id="screen-mindmap">

  <div class="state-tabs">
    <button class="state-tab active" onclick="setMapState('menu-open')">Menu Open</button>
    <button class="state-tab" onclick="setMapState('menu-closed')">Menu Closed</button>
    <button class="state-tab" onclick="setMapState('node-selected')">Node Selected</button>
  </div>

  <div class="sidebar-backdrop" id="map-backdrop" onclick="setMapState('menu-closed')"></div>

  <div class="app-shell">
    <!-- Top Bar -->
    <div class="app-topbar">
      <div class="app-logo">
        <div class="logo-mark" style="width:28px;height:28px;border-radius:8px;">
          <svg viewBox="0 0 20 20" fill="none" width="16" height="16"><circle cx="10" cy="10" r="3" fill="white"/><circle cx="10" cy="3" r="1.5" fill="white" opacity=".7"/><circle cx="10" cy="17" r="1.5" fill="white" opacity=".7"/><circle cx="3" cy="10" r="1.5" fill="white" opacity=".7"/><circle cx="17" cy="10" r="1.5" fill="white" opacity=".7"/><line x1="10" y1="10" x2="10" y2="4.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="10" y2="15.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="4.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="15.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/></svg>
        </div>
        <span class="logo-text" style="font-size:13px;">Research<span>Collab</span>.ai</span>
      </div>
      <div class="topbar-topic">
        <span class="topbar-topic-label">Topic</span>
        <span class="topbar-topic-val">Quantum Cognition</span>
      </div>
      <div class="topbar-actions">
        <button class="topbar-btn" id="map-sidebar-toggle" onclick="toggleSidebar()">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="1" y="2" width="12" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="6.25" width="8" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="10.5" width="10" height="1.5" rx=".75" fill="currentColor"/></svg>
          Nodes
        </button>
        <button class="topbar-btn">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><circle cx="7" cy="7" r="5.5" stroke="currentColor" stroke-width="1.2"/><path d="M7 4v3.5l2.5 1.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>
          History
        </button>
        <button class="topbar-btn">Share</button>
        <button class="topbar-btn primary" onclick="showScreen('outline')">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="2" y="2" width="10" height="10" rx="1.5" stroke="white" stroke-width="1.2"/><line x1="4.5" y1="5" x2="9.5" y2="5" stroke="white" stroke-width="1.2" stroke-linecap="round"/><line x1="4.5" y1="7" x2="9.5" y2="7" stroke="white" stroke-width="1.2" stroke-linecap="round"/><line x1="4.5" y1="9" x2="7" y2="9" stroke="white" stroke-width="1.2" stroke-linecap="round"/></svg>
          Generate Outline
        </button>
        <div class="topbar-avatar">JD</div>
      </div>
    </div>

    <div class="app-body">
      <!-- Sidebar -->
      <div class="app-sidebar" id="map-sidebar">
        <div class="sidebar-header">
          <span class="sidebar-title">Research Nodes</span>
          <button class="sidebar-close-btn" onclick="toggleSidebar()">✕</button>
        </div>
        <div class="sidebar-search">
          <input type="text" placeholder="Filter nodes…"/>
        </div>
        <div class="sidebar-scroll">
          <p class="sidebar-section-label">Core Concepts</p>
          <div class="node-item active">
            <div class="node-dot blue"></div>
            <span class="node-label">Quantum Cognition</span>
            <span class="node-badge">Central</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot blue"></div>
            <span class="node-label">Superposition Models</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot blue"></div>
            <span class="node-label">Decision Theory</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot gold"></div>
            <span class="node-label">Wave Function</span>
          </div>
          <p class="sidebar-section-label">Sub-Topics</p>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot green"></div>
            <span class="node-label">Neural Correlates</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot green"></div>
            <span class="node-label">Cognitive Bias</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot gold"></div>
            <span class="node-label">Entanglement</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot gray"></div>
            <span class="node-label">Probability Judgements</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot gray"></div>
            <span class="node-label">Hilbert Space</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot green"></div>
            <span class="node-label">Contextuality</span>
          </div>
          <p class="sidebar-section-label">Related Fields</p>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot gray"></div>
            <span class="node-label">Quantum Psychology</span>
          </div>
          <div class="node-item" onclick="setMapState('node-selected')">
            <div class="node-dot gray"></div>
            <span class="node-label">Behavioural Economics</span>
          </div>
        </div>
        <!-- Sidebar bottom action -->
        <div style="padding:12px; border-top:1px solid var(--cold); flex-shrink:0;">
          <button style="width:100%;height:40px;background:var(--hadfield);color:#fff;border:none;border-radius:var(--r-sm);font-size:13px;font-weight:600;cursor:pointer;" onclick="showScreen('outline')">
            Generate Outline →
          </button>
        </div>
      </div>

      <!-- Canvas -->
      <div class="app-canvas" id="map-canvas" style="position:relative;">
        <svg class="map-svg" id="map-svg"></svg>

        <!-- Mind map nodes (positioned via JS on load, manual fallback) -->
        <div class="map-node central" id="node-central" style="top:calc(50% - 22px); left:calc(50% - 80px);">Quantum Cognition</div>
        <div class="map-node branch-1" id="node-1" style="top:25%; left:25%;" onclick="setMapState('node-selected')">Superposition Models</div>
        <div class="map-node branch-1" id="node-2" style="top:20%; left:60%;" onclick="setMapState('node-selected')">Decision Theory</div>
        <div class="map-node branch-2" id="node-3" style="top:55%; left:18%;" onclick="setMapState('node-selected')">Wave Function</div>
        <div class="map-node branch-2" id="node-4" style="top:68%; left:58%;" onclick="setMapState('node-selected')">Cognitive Bias</div>
        <div class="map-node branch-3" id="node-5" style="top:35%; left:70%;" onclick="setMapState('node-selected')">Neural Correlates</div>
        <div class="map-node branch-3" id="node-6" style="top:72%; left:30%;" onclick="setMapState('node-selected')">Entanglement</div>
        <div class="map-node" id="node-7" style="top:15%; left:42%;" onclick="setMapState('node-selected')">Probability Judgements</div>
        <div class="map-node" id="node-8" style="top:75%; left:72%;" onclick="setMapState('node-selected')">Hilbert Space</div>

        <!-- Sidebar open button when closed -->
        <button class="sidebar-open-btn" id="sidebar-open-btn" style="display:none;" onclick="toggleSidebar()">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="1" y="2" width="12" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="6.25" width="8" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="10.5" width="10" height="1.5" rx=".75" fill="currentColor"/></svg>
        </button>

        <!-- Persistent Action Bar (zero scroll guarantee) -->
        <div class="canvas-action-bar">
          <button class="cab-btn" onclick="toggleSidebar()">
            <svg width="13" height="13" viewBox="0 0 13 13" fill="none"><rect x=".5" y="1" width="12" height="1.5" rx=".75" fill="currentColor"/><rect x=".5" y="5.5" width="8" height="1.5" rx=".75" fill="currentColor"/><rect x=".5" y="10" width="10" height="1.5" rx=".75" fill="currentColor"/></svg>
            Nodes
          </button>
          <div class="cab-divider"></div>
          <button class="cab-btn">
            <svg width="13" height="13" viewBox="0 0 13 13" fill="none"><circle cx="6.5" cy="6.5" r="5" stroke="currentColor" stroke-width="1.2"/><path d="M5 6.5h5M6.5 5v3" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>
          </button>
          <span class="zoom-display">100%</span>
          <button class="cab-btn">
            <svg width="13" height="13" viewBox="0 0 13 13" fill="none"><circle cx="6.5" cy="6.5" r="5" stroke="currentColor" stroke-width="1.2"/><path d="M4 6.5h5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>
          </button>
          <div class="cab-divider"></div>
          <button class="cab-btn">Expand All</button>
          <button class="cab-btn primary" onclick="showScreen('outline')">Generate Outline →</button>
        </div>
      </div>

      <!-- Node detail panel -->
      <div class="node-panel hidden" id="node-panel">
        <div class="node-panel-header">
          <span class="node-panel-title">Superposition Models</span>
          <button class="panel-close" onclick="setMapState('menu-open')">✕</button>
        </div>
        <div class="node-panel-body">
          <p class="panel-section-title">Overview</p>
          <p class="panel-abstract">Superposition models in quantum cognition apply the mathematical framework of quantum mechanics to model human judgment. Unlike classical probability, these models allow for states of belief that exist in multiple configurations simultaneously until a decision is reached.</p>
          <p class="panel-section-title" style="margin-top:16px;">Tags</p>
          <span class="panel-tag">Quantum probability</span>
          <span class="panel-tag">Belief states</span>
          <span class="panel-tag">Decision-making</span>
          <p class="panel-section-title" style="margin-top:16px;">Key Papers</p>
          <div style="font-size:12px; color:var(--mid); line-height:1.6; padding:10px; background:var(--bleached); border-radius:6px; margin-bottom:8px;">
            Busemeyer & Bruza (2012). Quantum Models of Cognition and Decision. <em>Cambridge University Press.</em>
          </div>
          <div style="font-size:12px; color:var(--mid); line-height:1.6; padding:10px; background:var(--bleached); border-radius:6px;">
            Pothos & Busemeyer (2009). A quantum probability explanation for violations of 'rational' decision theory. <em>Proc. R. Soc. B.</em>
          </div>
          <button class="panel-action-btn" onclick="showScreen('outline')">Add to Outline →</button>
        </div>
      </div>
    </div>

    <!-- Mobile sticky action bar -->
    <div class="mobile-toggle-bar">
      <button class="mob-action-btn secondary" onclick="toggleSidebar()">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="1" y="2" width="12" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="6.25" width="8" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="10.5" width="10" height="1.5" rx=".75" fill="currentColor"/></svg>
        Nodes
      </button>
      <button class="mob-action-btn primary" onclick="showScreen('outline')">Generate Outline →</button>
    </div>
  </div>
</div>


<!-- ════════════════════════════════════════════════════════════
     SCREEN 4 — OUTLINE GENERATOR
     ════════════════════════════════════════════════════════════ -->
<div class="screen" id="screen-outline">

  <div class="state-tabs">
    <button class="state-tab active" onclick="setOutlineState('menu-open')">Menu Open</button>
    <button class="state-tab" onclick="setOutlineState('menu-closed')">Menu Closed</button>
  </div>

  <div class="sidebar-backdrop" id="outline-backdrop" onclick="setOutlineState('menu-closed')"></div>

  <div class="outline-shell">
    <!-- Same top bar -->
    <div class="app-topbar">
      <div class="app-logo">
        <div class="logo-mark" style="width:28px;height:28px;border-radius:8px;">
          <svg viewBox="0 0 20 20" fill="none" width="16" height="16"><circle cx="10" cy="10" r="3" fill="white"/><circle cx="10" cy="3" r="1.5" fill="white" opacity=".7"/><circle cx="10" cy="17" r="1.5" fill="white" opacity=".7"/><circle cx="3" cy="10" r="1.5" fill="white" opacity=".7"/><circle cx="17" cy="10" r="1.5" fill="white" opacity=".7"/><line x1="10" y1="10" x2="10" y2="4.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="10" y2="15.5" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="4.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/><line x1="10" y1="10" x2="15.5" y2="10" stroke="white" stroke-width="1" opacity=".5"/></svg>
        </div>
        <span class="logo-text" style="font-size:13px;">Research<span>Collab</span>.ai</span>
      </div>
      <div class="topbar-topic">
        <span class="topbar-topic-label">Outline</span>
        <span class="topbar-topic-val">Quantum Cognition — Research Outline</span>
      </div>
      <div class="topbar-actions">
        <button class="topbar-btn" id="outline-sidebar-toggle" onclick="toggleOutlineSidebar()">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><rect x="1" y="2" width="12" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="6.25" width="8" height="1.5" rx=".75" fill="currentColor"/><rect x="1" y="10.5" width="10" height="1.5" rx=".75" fill="currentColor"/></svg>
          Sections
        </button>
        <button class="topbar-btn" onclick="showScreen('mindmap')">← Mind Map</button>
        <button class="topbar-btn">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M7 2v7M4 6l3 3 3-3" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/><rect x="2" y="10" width="10" height="2" rx="1" fill="currentColor" opacity=".4"/></svg>
          Export
        </button>
        <div class="topbar-avatar">JD</div>
      </div>
    </div>

    <div class="outline-body">
      <!-- Outline sidebar -->
      <div class="outline-sidebar" id="outline-sidebar">
        <div class="outline-sidebar-inner">
          <div class="sidebar-header">
            <span class="sidebar-title">Sections</span>
            <button class="sidebar-close-btn" onclick="toggleOutlineSidebar()">✕</button>
          </div>
          <div class="outline-sec-list">
            <div class="osec-item active">
              <div class="osec-num">1</div>
              <span class="osec-label">Introduction</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">2</div>
              <span class="osec-label">Theoretical Framework</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">3</div>
              <span class="osec-label">Superposition Models</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">4</div>
              <span class="osec-label">Decision Theory Applications</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">5</div>
              <span class="osec-label">Neural Correlates</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">6</div>
              <span class="osec-label">Methodology</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">7</div>
              <span class="osec-label">Discussion</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">8</div>
              <span class="osec-label">Conclusion</span>
            </div>
            <div class="osec-item">
              <div class="osec-num">R</div>
              <span class="osec-label">References</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Outline document -->
      <div class="outline-main" id="outline-main">
        <div class="outline-doc-header">
          <span class="outline-doc-tag">Research Outline</span>
          <h1 class="outline-doc-title">Quantum Cognition: Superposition, Decision-Making, and Neural Correlates</h1>
          <div class="outline-doc-meta">
            <span class="outline-meta-item">
              <svg class="outline-meta-icon" viewBox="0 0 16 16" fill="none"><circle cx="8" cy="8" r="6.5" stroke="#8892a4" stroke-width="1.2"/><path d="M8 5v3.5l2 1.5" stroke="#8892a4" stroke-width="1.2" stroke-linecap="round"/></svg>
              8 Sections
            </span>
            <span class="outline-meta-item">
              <svg class="outline-meta-icon" viewBox="0 0 16 16" fill="none"><rect x="2" y="2" width="12" height="12" rx="1.5" stroke="#8892a4" stroke-width="1.2"/><line x1="5" y1="6" x2="11" y2="6" stroke="#8892a4" stroke-width="1.2" stroke-linecap="round"/><line x1="5" y1="9" x2="8" y2="9" stroke="#8892a4" stroke-width="1.2" stroke-linecap="round"/></svg>
              23 Sub-sections
            </span>
            <span class="outline-meta-item" style="color:var(--hadfield);">
              <svg class="outline-meta-icon" viewBox="0 0 16 16" fill="none"><path d="M3 12l4-4 3 3 3-4" stroke="#0e70ff" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              Doctoral Level
            </span>
          </div>
        </div>

        <!-- Section 1 -->
        <div class="outline-section">
          <div class="outline-section-head">
            <span class="outline-sec-num">1</span>
            <h2 class="outline-sec-title">Introduction</h2>
          </div>
          <div class="outline-subsections">
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">1.1</span>
                <span class="outline-subsec-title">Background and Motivation</span>
              </div>
              <p class="outline-subsec-desc">Overview of the intersection between quantum mechanical formalisms and cognitive science. Situates the research within the broader context of post-classical theories of mind.</p>
              <div class="outline-keywords">
                <span class="outline-kw">quantum formalism</span>
                <span class="outline-kw">cognitive science</span>
                <span class="outline-kw">interdisciplinary</span>
              </div>
            </div>
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">1.2</span>
                <span class="outline-subsec-title">Research Questions and Scope</span>
              </div>
              <p class="outline-subsec-desc">Defines the primary and secondary research questions. Establishes conceptual scope and identifies key theoretical limitations.</p>
            </div>
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">1.3</span>
                <span class="outline-subsec-title">Significance and Contribution</span>
              </div>
              <p class="outline-subsec-desc">Articulates the novel contribution to existing literature and the practical implications for decision science and cognitive modelling.</p>
            </div>
          </div>
        </div>

        <!-- Section 2 -->
        <div class="outline-section">
          <div class="outline-section-head">
            <span class="outline-sec-num">2</span>
            <h2 class="outline-sec-title">Theoretical Framework</h2>
          </div>
          <div class="outline-subsections">
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">2.1</span>
                <span class="outline-subsec-title">Classical vs. Quantum Probability</span>
              </div>
              <p class="outline-subsec-desc">Contrasts Kolmogorovian probability axioms with quantum probability theory. Examines where classical models fail to account for observed cognitive phenomena.</p>
              <div class="outline-keywords">
                <span class="outline-kw">Kolmogorov axioms</span>
                <span class="outline-kw">quantum probability</span>
                <span class="outline-kw">conjunction fallacy</span>
              </div>
            </div>
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">2.2</span>
                <span class="outline-subsec-title">Hilbert Space Formalism</span>
              </div>
              <p class="outline-subsec-desc">Introduces Hilbert space as the mathematical arena for modelling belief states. Covers unit vectors, projectors, and measurement operators as cognitive analogues.</p>
            </div>
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">2.3</span>
                <span class="outline-subsec-title">Order Effects in Judgement</span>
              </div>
              <p class="outline-subsec-desc">Reviews empirical evidence for order effects in human judgement tasks that are naturally explained by quantum rather than classical models.</p>
            </div>
          </div>
        </div>

        <!-- Section 3 -->
        <div class="outline-section">
          <div class="outline-section-head">
            <span class="outline-sec-num">3</span>
            <h2 class="outline-sec-title">Superposition Models of Cognition</h2>
          </div>
          <div class="outline-subsections">
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">3.1</span>
                <span class="outline-subsec-title">Quantum Belief Superposition</span>
              </div>
              <p class="outline-subsec-desc">Models belief as existing in a superposition of multiple potential states before a question forces a definitive response — a "measurement" in quantum terms.</p>
              <div class="outline-keywords">
                <span class="outline-kw">belief states</span>
                <span class="outline-kw">superposition</span>
                <span class="outline-kw">measurement collapse</span>
              </div>
            </div>
            <div>
              <div class="outline-subsec">
                <span class="outline-subsec-num">3.2</span>
                <span class="outline-subsec-title">Interference Effects</span>
              </div>
              <p class="outline-subsec-desc">Explores constructive and destructive interference between belief states as a mechanism for explaining disjunction effects and other cognitive anomalies.</p>
            </div>
          </div>
        </div>

        <!-- More sections abbreviated -->
        <div class="outline-section" style="opacity:.6;">
          <div class="outline-section-head">
            <span class="outline-sec-num">4</span>
            <h2 class="outline-sec-title">Decision Theory Applications</h2>
          </div>
          <div class="outline-subsections">
            <div class="outline-subsec"><span class="outline-subsec-num">4.1</span><span class="outline-subsec-title">Prisoner's Dilemma Violations</span></div>
            <div class="outline-subsec"><span class="outline-subsec-num">4.2</span><span class="outline-subsec-title">Prospect Theory Intersections</span></div>
            <div class="outline-subsec"><span class="outline-subsec-num">4.3</span><span class="outline-subsec-title">Ambiguity and Uncertainty Modelling</span></div>
          </div>
        </div>
        <div class="outline-section" style="opacity:.6;">
          <div class="outline-section-head">
            <span class="outline-sec-num">5</span>
            <h2 class="outline-sec-title">Neural Correlates</h2>
          </div>
          <div class="outline-subsections">
            <div class="outline-subsec"><span class="outline-subsec-num">5.1</span><span class="outline-subsec-title">Neuroimaging Evidence</span></div>
            <div class="outline-subsec"><span class="outline-subsec-num">5.2</span><span class="outline-subsec-title">Entanglement Analogues in Neural Networks</span></div>
          </div>
        </div>

        <div style="height:120px;"></div><!-- padding for sticky bar -->
      </div>

      <!-- Right suggestions panel -->
      <div class="outline-right" id="outline-right">
        <p class="or-title">AI Suggestions</p>
        <div class="or-suggestion">
          <p class="or-sug-label">Missing subsection</p>
          <p class="or-sug-text">Consider adding a subsection on "Quantum Zeno Effect" under Section 3 — highly cited in the literature.</p>
        </div>
        <div class="or-suggestion">
          <p class="or-sug-label">Citation gap</p>
          <p class="or-sug-text">Section 2.1 would benefit from Tversky & Kahneman (1983) on the conjunction fallacy.</p>
        </div>
        <div class="or-suggestion">
          <p class="or-sug-label">Structure tip</p>
          <p class="or-sug-text">Sections 4 and 5 could be merged for a tighter argument chain — common in doctoral theses at this scope.</p>
        </div>
        <div class="or-suggestion">
          <p class="or-sug-label">Related topic</p>
          <p class="or-sug-text">Contextuality (Kochen-Specker theorem) is a frequent companion topic — want to add a node?</p>
        </div>
      </div>
    </div>

    <!-- Persistent action bar (fixed, zero-scroll guarantee) -->
    <div class="outline-action-bar" id="outline-action-bar">
      <button class="oab-btn" onclick="toggleOutlineSidebar()">
        <svg width="13" height="13" viewBox="0 0 13 13" fill="none"><rect x=".5" y="1" width="12" height="1.5" rx=".75" fill="currentColor"/><rect x=".5" y="5.5" width="8" height="1.5" rx=".75" fill="currentColor"/><rect x=".5" y="10" width="10" height="1.5" rx=".75" fill="currentColor"/></svg>
        Sections
      </button>
      <div class="oab-sep"></div>
      <button class="oab-btn">Regenerate</button>
      <button class="oab-btn primary">
        <svg width="13" height="13" viewBox="0 0 13 13" fill="none"><path d="M6.5 1.5v7M3.5 5.5l3 3 3-3" stroke="white" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/><rect x="1.5" y="10" width="10" height="2" rx="1" fill="white" opacity=".5"/></svg>
        Export as DOCX
      </button>
      <button class="oab-btn gold">Create Content →</button>
    </div>

    <!-- Mobile sticky bar -->
    <div class="mobile-toggle-bar">
      <button class="mob-action-btn secondary" onclick="toggleOutlineSidebar()">Sections</button>
      <button class="mob-action-btn primary">Create Content →</button>
    </div>
  </div>
</div>


<!-- ════════════════════════════════════════════════════════════
     JAVASCRIPT
     ════════════════════════════════════════════════════════════ -->
<script>
/* ──────────────────────────────────────────────────────────────
   SCREEN NAVIGATION
   ────────────────────────────────────────────────────────────── */
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + id).classList.add('active');
  document.querySelectorAll('.snav-btn').forEach(b => b.classList.remove('active'));
  const map = {homepage:'0',signin:'1',signup:'2',mindmap:'3',outline:'4'};
  document.querySelectorAll('.snav-btn')[parseInt(map[id])]?.classList.add('active');
  window.scrollTo(0,0);
  if (id === 'mindmap') { setTimeout(drawMapLines, 100); }
  if (id === 'outline') { setOutlineState('menu-open'); }
}

/* ──────────────────────────────────────────────────────────────
   HOMEPAGE — Canvas node network effect
   ────────────────────────────────────────────────────────────── */
(function initHeroCanvas() {
  const canvas = document.getElementById('hero-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H, nodes = [], animId;

  function resize() {
    W = canvas.width  = canvas.offsetWidth;
    H = canvas.height = canvas.offsetHeight;
  }

  function randomNode() {
    return {
      x: Math.random() * W, y: Math.random() * H,
      vx: (Math.random() - .5) * .4, vy: (Math.random() - .5) * .4,
      r: Math.random() * 2 + 1.5
    };
  }

  function init() {
    resize();
    nodes = Array.from({ length: 55 }, randomNode);
  }

  function draw() {
    ctx.clearRect(0, 0, W, H);
    // Update
    nodes.forEach(n => {
      n.x += n.vx; n.y += n.vy;
      if (n.x < 0 || n.x > W) n.vx *= -1;
      if (n.y < 0 || n.y > H) n.vy *= -1;
    });
    // Edges
    const DIST = 130;
    for (let i = 0; i < nodes.length; i++) {
      for (let j = i + 1; j < nodes.length; j++) {
        const dx = nodes[i].x - nodes[j].x;
        const dy = nodes[i].y - nodes[j].y;
        const d = Math.sqrt(dx*dx + dy*dy);
        if (d < DIST) {
          ctx.beginPath();
          ctx.moveTo(nodes[i].x, nodes[i].y);
          ctx.lineTo(nodes[j].x, nodes[j].y);
          ctx.strokeStyle = `rgba(14,112,255,${.12 * (1 - d/DIST)})`;
          ctx.lineWidth = .8;
          ctx.stroke();
        }
      }
    }
    // Dots
    nodes.forEach(n => {
      ctx.beginPath();
      ctx.arc(n.x, n.y, n.r, 0, Math.PI*2);
      ctx.fillStyle = 'rgba(14,112,255,.25)';
      ctx.fill();
    });
    animId = requestAnimationFrame(draw);
  }

  init();
  draw();
  window.addEventListener('resize', () => { init(); });
})();

/* Auth canvas (same but dimmer on dark bg) */
function initAuthCanvas(canvasId) {
  const canvas = document.getElementById(canvasId);
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H, nodes = [], animId;
  function resize() { W = canvas.width = canvas.offsetWidth; H = canvas.height = canvas.offsetHeight; }
  function rn() { return { x:Math.random()*W, y:Math.random()*H, vx:(Math.random()-.5)*.3, vy:(Math.random()-.5)*.3, r:Math.random()*2+1 }; }
  function init() { resize(); nodes = Array.from({length:40},rn); }
  function draw() {
    ctx.clearRect(0,0,W,H);
    nodes.forEach(n => { n.x+=n.vx; n.y+=n.vy; if(n.x<0||n.x>W)n.vx*=-1; if(n.y<0||n.y>H)n.vy*=-1; });
    for(let i=0;i<nodes.length;i++){for(let j=i+1;j<nodes.length;j++){const dx=nodes[i].x-nodes[j].x,dy=nodes[i].y-nodes[j].y,d=Math.sqrt(dx*dx+dy*dy);if(d<120){ctx.beginPath();ctx.moveTo(nodes[i].x,nodes[i].y);ctx.lineTo(nodes[j].x,nodes[j].y);ctx.strokeStyle=`rgba(255,255,255,${.07*(1-d/120)})`;ctx.lineWidth=.7;ctx.stroke();}}}
    nodes.forEach(n=>{ctx.beginPath();ctx.arc(n.x,n.y,n.r,0,Math.PI*2);ctx.fillStyle='rgba(255,255,255,.15)';ctx.fill();});
    requestAnimationFrame(draw);
  }
  init(); draw(); window.addEventListener('resize', ()=>init());
}
initAuthCanvas('auth-canvas');
initAuthCanvas('auth-canvas-2');

/* ──────────────────────────────────────────────────────────────
   HOMEPAGE — Mobile menu
   ────────────────────────────────────────────────────────────── */
let mobileMenuOpen = false;
function toggleMobileMenu(force) {
  const menu = document.getElementById('hp-mobile-menu');
  const btn = document.getElementById('hp-hamburger');
  mobileMenuOpen = force !== undefined ? force : !mobileMenuOpen;
  menu.style.display = mobileMenuOpen ? 'block' : 'none';
  document.querySelectorAll('#screen-homepage .state-tab').forEach((t,i) => {
    t.classList.toggle('active', i === (mobileMenuOpen ? 1 : 0));
  });
}

/* ──────────────────────────────────────────────────────────────
   MINI MINDMAP LINES (hero mockup)
   ────────────────────────────────────────────────────────────── */
function drawMiniMapLines() {
  const svg = document.getElementById('mini-svg');
  const map = document.getElementById('mini-map');
  if (!svg || !map) return;
  const center = document.getElementById('mc');
  const nodes = ['mn1','mn2','mn3','mn4','mn5','mn6'];
  svg.innerHTML = '';
  const mr = map.getBoundingClientRect();
  const cr = center.getBoundingClientRect();
  const cx = cr.left - mr.left + cr.width/2;
  const cy = cr.top - mr.top + cr.height/2;
  nodes.forEach(id => {
    const n = document.getElementById(id);
    if (!n) return;
    const nr = n.getBoundingClientRect();
    const nx = nr.left - mr.left + nr.width/2;
    const ny = nr.top - mr.top + nr.height/2;
    const line = document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('x1', cx); line.setAttribute('y1', cy);
    line.setAttribute('x2', nx); line.setAttribute('y2', ny);
    line.setAttribute('stroke', 'rgba(14,112,255,.25)');
    line.setAttribute('stroke-width', '1.5');
    svg.appendChild(line);
  });
}
setTimeout(drawMiniMapLines, 500);
window.addEventListener('resize', drawMiniMapLines);

/* ──────────────────────────────────────────────────────────────
   MIND MAP — Sidebar toggle
   ────────────────────────────────────────────────────────────── */
let sidebarOpen = true;
let nodePanelOpen = false;

function toggleSidebar() {
  sidebarOpen = !sidebarOpen;
  const sidebar = document.getElementById('map-sidebar');
  const openBtn = document.getElementById('sidebar-open-btn');
  const backdrop = document.getElementById('map-backdrop');
  sidebar.classList.toggle('closed', !sidebarOpen);
  if (openBtn) openBtn.style.display = sidebarOpen ? 'none' : 'grid';
  if (window.innerWidth <= 768) {
    if (backdrop) backdrop.classList.toggle('visible', sidebarOpen);
  }
  setTimeout(drawMapLines, 320);
}

function setMapState(state) {
  const sidebar = document.getElementById('map-sidebar');
  const panel = document.getElementById('node-panel');
  const backdrop = document.getElementById('map-backdrop');
  const openBtn = document.getElementById('sidebar-open-btn');
  const tabs = document.querySelectorAll('#screen-mindmap .state-tab');

  if (state === 'menu-open') {
    sidebarOpen = true;
    sidebar.classList.remove('closed');
    panel.classList.add('hidden');
    if(openBtn) openBtn.style.display='none';
    if(backdrop) backdrop.classList.remove('visible');
    tabs[0]?.classList.add('active'); tabs[1]?.classList.remove('active'); tabs[2]?.classList.remove('active');
  } else if (state === 'menu-closed') {
    sidebarOpen = false;
    sidebar.classList.add('closed');
    panel.classList.add('hidden');
    if(openBtn) openBtn.style.display='grid';
    if(backdrop) backdrop.classList.remove('visible');
    tabs[0]?.classList.remove('active'); tabs[1]?.classList.add('active'); tabs[2]?.classList.remove('active');
  } else if (state === 'node-selected') {
    sidebarOpen = true;
    sidebar.classList.remove('closed');
    panel.classList.remove('hidden');
    if(openBtn) openBtn.style.display='none';
    if(backdrop) backdrop.classList.remove('visible');
    tabs[0]?.classList.remove('active'); tabs[1]?.classList.remove('active'); tabs[2]?.classList.add('active');
  }
  setTimeout(drawMapLines, 320);
}

/* ──────────────────────────────────────────────────────────────
   MIND MAP — Draw SVG connector lines
   ────────────────────────────────────────────────────────────── */
function drawMapLines() {
  const svg = document.getElementById('map-svg');
  const canvas = document.getElementById('map-canvas');
  if (!svg || !canvas) return;
  svg.innerHTML = '';
  const cr = canvas.getBoundingClientRect();
  const central = document.getElementById('node-central');
  if (!central) return;
  const centralR = central.getBoundingClientRect();
  const cx = centralR.left - cr.left + centralR.width/2;
  const cy = centralR.top - cr.top + centralR.height/2;

  const connections = [
    {id:'node-1', cls:'branch-1-line'},
    {id:'node-2', cls:'branch-1-line'},
    {id:'node-3', cls:'branch-2-line'},
    {id:'node-4', cls:'branch-2-line'},
    {id:'node-5', cls:'branch-3-line'},
    {id:'node-6', cls:'branch-3-line'},
    {id:'node-7', cls:''},
    {id:'node-8', cls:''},
  ];

  connections.forEach(({id, cls}) => {
    const n = document.getElementById(id);
    if (!n) return;
    const nr = n.getBoundingClientRect();
    const nx = nr.left - cr.left + nr.width/2;
    const ny = nr.top - cr.top + nr.height/2;
    const line = document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('x1', cx); line.setAttribute('y1', cy);
    line.setAttribute('x2', nx); line.setAttribute('y2', ny);
    if (cls) line.setAttribute('class', cls);
    svg.appendChild(line);
  });
}

/* ──────────────────────────────────────────────────────────────
   OUTLINE — Sidebar toggle
   ────────────────────────────────────────────────────────────── */
let outlineSidebarOpen = true;

function toggleOutlineSidebar() {
  outlineSidebarOpen = !outlineSidebarOpen;
  setOutlineState(outlineSidebarOpen ? 'menu-open' : 'menu-closed');
}

function setOutlineState(state) {
  const sidebar = document.getElementById('outline-sidebar');
  const backdrop = document.getElementById('outline-backdrop');
  const tabs = document.querySelectorAll('#screen-outline .state-tab');
  outlineSidebarOpen = state === 'menu-open';
  sidebar.classList.toggle('closed', !outlineSidebarOpen);
  if(window.innerWidth <= 768 && backdrop) {
    backdrop.classList.toggle('visible', outlineSidebarOpen);
  }
  tabs[0]?.classList.toggle('active', outlineSidebarOpen);
  tabs[1]?.classList.toggle('active', !outlineSidebarOpen);
}

/* ──────────────────────────────────────────────────────────────
   INIT — Run defaults
   ────────────────────────────────────────────────────────────── */
setTimeout(() => {
  drawMapLines();
  setMapState('menu-open');
  setOutlineState('menu-open');
}, 200);

window.addEventListener('resize', drawMapLines);

/* Nav scroll effect */
window.addEventListener('scroll', () => {
  const nav = document.getElementById('hp-nav');
  if(nav) nav.classList.toggle('scrolled', window.scrollY > 20);
});

</script>
</body>
</html>
